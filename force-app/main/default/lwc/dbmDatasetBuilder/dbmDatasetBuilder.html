<template>
    <div class="builderContainer slds-grid slds-grid_vertical">
        {reportDetailsString}
        <div class="builderHeader slds-grid slds-grid_vertical-align-center slds-p-vertical_x-small slds-border_bottom">
            <lightning-button label="Back" onclick={handleBackButtonClick}
                disabled={backButtonIsDisabled}></lightning-button>
            <c-stage-path stages={builderSteps} current-stage-index={currentStepIndex} onstageclick={handleStepClick}
                class="slds-col slds-p-horizontal_x-small"></c-stage-path>
            <lightning-button label="Next" onclick={handleNextButtonClick}></lightning-button>
        </div>
        <div class="builderBody slds-col slds-grid slds-gutters">
            <div class="contentPane slds-col" onmouseup={handleContentPaneMouseUp}>
                <template lwc:if={currentStepIs.details}>
                    <c-dbm-dataset-details report-details={reportDetails}
                        onreportdetailchange={handleReportDetailChange}></c-dbm-dataset-details>
                </template>
                <template lwc:if={currentStepIs.groupings}>
                    <c-dbm-dataset-groupings report-details={reportDetails}
                        onreportdetailchange={handleReportDetailChange}></c-dbm-dataset-groupings>
                </template>
                <template lwc:if={currentStepIs.data}>
                    <c-dbm-dataset-data report-details={reportDetails}
                        onreportdetailchange={handleReportDetailChange}></c-dbm-dataset-data>
                </template>
            </div>
            <div class="previewPane" style={previewPaneStyle}>
                <template lwc:if={showPreviewEnlargeButton}>
                    <lightning-button-icon class="previewEnlargeButton" icon-name="utility:left" variant="bare" size="medium" tooltip="Expand preview" title="Shrink preview"
                        onclick={handlePreviewEnlargeClick}></lightning-button-icon>
                </template>
                <template lwc:if={previewPaneWidth}>
                    <lightning-button-icon class="previewShrinkButton" icon-name="utility:right" variant="bare" size="medium" tooltip="Shrink preview" title="Shrink preview"
                        onclick={handlePreviewShrinkClick}></lightning-button-icon>
                    <c-dbm-preview report-details={reportDetails}></c-dbm-preview>
                </template>
            </div>
        </div>
    </div>
</template>